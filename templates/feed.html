{% extends "me_options.html" %}

{% block script %}
<script>
$(document).ready(
    function loadmorefeed(){

  var fetch_url = "/loadmore";
  var next_page = 2; 
  $(".click-load-more").click(function(){
    $.post(fetch_url,
    {
      type:1,
      page_num:next_page
    },
    function(data,status){
      alert("数据：" + data.ret + "\nnumb：" + data.cnt);
      $("#clip-list").append(data.ret);
      if(data.cnt < 10)
      {
        $("#load-more").remove();
      }
      next_page = next_page + 1;
    },
    "json");
  });
  return true;
});
</script>
{% end %}

{% block option_body %}

    <div id="clips" style="display: block;">
        <div class="clearfix">
            <div id="list-info">
                <h3 title="All Links" class="name">
                   My Feed
                </h3>
            </div>
            <div id="new-clip">
                <input type="text" placeholder="Add a link...">
            </div>
        </div>
        <div id="clips-container">
            <ul class="unstyled" id="clip-list" style="display: block;">
                {% for link in links %}
                <li class="clip">
                    <div class="clip-content">
                        <span class="clip-date"><i class="icon icon-date"></i>
                            {{ link.created }}
                        </span>
                        <a rel="nofollow" class="clip-title" target="_blank" href="{{ link.url }}">
                            {{ link.title }}
                        </a>
                        <p class="domain">
                            <span>{{ link.url_domain }}</span>
                            <span class="comment-count">
                                <a title="Comment" href="/me/comment/{{link.id}}/%2Fme%2Ffeed">
                                    <i class="icon icon-comment"></i>
                                    {% if link.comments_count > 0%}
                                    <strong> {{ link.comments_count }}
                                    </strong>
                                    {% end %}
                                    Comment
                                </a>
                            </span>
                            <span>
                                <a class="like  " href="#">
                                    <i class="icon icon-like"></i>
                                    <span>
                                        {% if link.like_count > 0 %}
                                        {{ link.like_count}} likes
                                        {% else %}
                                        likes
                                        {% end %}
                                    </span>
                                </a>
                            </span>
                            <span>
                                <a class="like  " href="#">
                                    <i class="icon icon-edit pull-right"> Edit</i>
                                </a>
                            </span>
                        </p>
                    </div>

                    {% if link.comments_count > 0 %}
                    <div class="feed-comments">
                        {% for comment in link.comments %}
                        <ul style="list-style:none">
                            <li>
                                <div class="clip-content">
                                    <div style="float:right">
                                        <span class="clip-date">
                                            <i class="icon icon-date">
                                            </i>
                                            {{ comment.created }}
                                        </span>
                                    </div>
                                    <a href="#">
                                        <img width="32" class="avatar"
                                        src="{{static_url("images/me.jpeg")}}&amp;s=160">
                                    </a>
                                    
                                    <a href="#">{{user.username}}</a>
                                    <span class="s">
                                    {{comment.content}}
                                    </span>
                                </div>
                            </li>
                        </ul>
                        {% end %}
                        <div class="reply" style="padding-left:25px">
                            <form class="add-comment" action="/me/entercomment/{{link.id}}/%2Fme%2Ffeed">
                                <img width="32" class="avatar" src="{{static_url("images/me.jpeg")}}&amp;s=160">
                                <input type="text" placeholder="Leave a comment..." name="enter">
                            </form>
                        </div>
                    </div>
                    {% end %}


                </li>
                {% end %}
            </ul>
            <div style="display:block;margin:15px 10px;text-align:center;font-size:23px" id="load-more">
                <a class="click-load-more" href="#" style="color: #848484;" onclick="return loadmorefeed();">Click here to view more!</a>
            </div>

            <div id="no-clips" style="display: none;">
                <p>
                    <strong>Find clips to add to this list</strong>
                    You can add links with extensions, bookmarklets and via email. 
                    <a href="/tools/">View the tools</a>
                </p>
                <p class="no-collaborate">
                    <strong>Collaborate with your team.</strong> 
                    Invite people to this list and easily share useful links
                </p>
                <p class="no-public">
                    <strong>Make your list public</strong>. 
                    Share the interesting things you find and save.
                </p>
            </div>
            <div id="no-search-results" style="display: none;">No search results.
            </div>
        </div>
    </div>
    {% end %}

